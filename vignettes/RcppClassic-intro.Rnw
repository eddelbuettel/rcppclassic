\documentclass[11pt]{article}
%\VignetteIndexEntry{RcppClassic}
%\VignetteKeywords{R,Rcpp,API}
%\VignettePackage{RcppClassic}
%\VignetteEngine{highlight::highlight}

\usepackage{vmargin}
\setmargrb{0.75in}{0.75in}{0.75in}{0.75in}
\usepackage{graphicx,color}

\usepackage[colorlinks]{hyperref}
\definecolor{link}{rgb}{0,0,0.3}	%% next few lines courtesy of RJournal.sty
\hypersetup{
    colorlinks,%
    citecolor=link,%
    filecolor=link,%
    linkcolor=link,%
    urlcolor=link
}

\usepackage{microtype}                     %% cf http://www.khirevich.com/latex/microtype/
\usepackage[T1]{fontenc}		   %% cf http://www.khirevich.com/latex/font/
\usepackage[bitstream-charter]{mathdesign} %% cf http://www.khirevich.com/latex/font/

\newcommand{\proglang}[1]{\textsf{#1}}
\newcommand{\pkg}[1]{{\fontseries{b}\selectfont #1}}

\usepackage[authoryear,round,longnamesfirst]{natbib}

\newsavebox{\hlbox}
\definecolor{hlBg}{rgb}{0.949019607843137,0.949019607843137,0.949019607843137}
\definecolor{hlBd}{rgb}{0,0,0}
\renewenvironment{Hchunk}{\vspace{0.125em}\noindent\begin{lrbox}{\hlbox}\begin{minipage}[b]{.98\linewidth}}%
    {\end{minipage}\end{lrbox}\fcolorbox{hlBd}{hlBg}{\usebox{\hlbox}}\vspace{0.125em}}

<<echo=FALSE,print=FALSE>>=
require( RcppClassic )
prettyVersion <- packageDescription("RcppClassic")$Version
prettyDate <- format(Sys.Date(), "%B %e, %Y")
RcppBibfile <- sub("\\.bib$", "", Rcpp:::bib())
@

\title{\pkg{RcppClassic}: Deprecated Rcpp API}
\author{Dirk Eddelbuettel \and Romain Fran\c{c}ois}
\date{\pkg{RcppClassic} version \Sexpr{prettyVersion} as of \Sexpr{prettyDate}}

\begin{document}

\maketitle

\noindent
This document presents the \pkg{RcppClassic} package. This package
has been factored out of \pkg{Rcpp} \citep{JSS:Rcpp,CRAN:Rcpp,Eddelbuettel:2013:Rcpp}
and only contains code that is considered deprecated.

This package is released for the sole purpose of allowing package authors
that are still using the classic \pkg{Rcpp} API to keep
their package buildable. This document explains the changes needed in
a package to use both the current and classic \pkg{Rcpp} APIs.

\section{If you must use \pkg{RcppClassic}}

A few changes are needed in packages that want to use the classic \pkg{Rcpp}
API that is contained in \pkg{RcppClassic}. A sample package called
\pkg{RcppClassicExample} is on CRAN and can be used as a template.

\subsection{The DESCRIPTION file}

The client package must declare that it depends on both \pkg{Rcpp} and \pkg{RcppClassic}
in the Imports field and the LinkingTo field, so it must contain this:

<<lang=sh>>=
Imports: RcppClassic, Rcpp
LinkingTo: RcppClassic, Rcpp
@

\subsection{The NAMESPACE file}

The client package should import both \pkg{Rcpp} and \pkg{RcppClassic}:

<<eval=FALSE,prompt="">>=
importFrom(Rcpp, evalCpp)
import(RcppClassic)
@

\subsection{Makevars}

The Makevars file must be updated so that user libraries for both Rcpp
and RcppClassic are used:


<<lang=make>>=
PKG_LIBS = `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` \
           `$(R_HOME)/bin/Rscript -e "RcppClassic:::LdFlags()"`
@

Starting with \pkg{Rcpp} version 0.11.0, the result of \verb|Rcpp:::LdFlags()| is
an empty string as Rcpp no longer provides a user-library. The above then
reduces to

<<lang=make>>=
PKG_LIBS = `$(R_HOME)/bin/Rscript -e "RcppClassic:::LdFlags()"`
@


\subsection{Makevars.win}

The Makevars.win must also be updated for the same reason:

<<lang=make>>=
PKG_LIBS = $(shell "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe" -e "Rcpp:::LdFlags()")
PKG_LIBS += $(shell "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe" -e "RcppClassic:::LdFlags()")
@

Similarly, when \pkg{Rcpp} 0.11.0 or later is used, the following is
sufficient:

<<lang=make>>=
PKG_LIBS = $(shell "${R_HOME}/bin${R_ARCH_BIN}/Rscript.exe" -e "RcppClassic:::LdFlags()")
@


\subsection{Include RcppClassic.h instead of Rcpp.h}

Finally, all instances of this line :

<<lang=cpp>>=
#include <Rcpp.h>
@

need to be replaced by:

<<lang=cpp>>=
#include <RcppClassic.h>
@


\section{You should not use RcppClassic}

The previous section discusses the set of changes required to update a
package so that it uses the classic API from \pkg{RcppClassic} since it has
been removed from \pkg{Rcpp}.

We do, however, recommend that package authors stop using the classic API,
which is largely superseded by the current \pkg{Rcpp} API, in terms of
performance, design, maintainance and ease of use.


\bibliographystyle{plainnat}
\bibliography{\Sexpr{RcppBibfile}}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
